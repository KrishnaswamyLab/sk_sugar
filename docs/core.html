---

title: core


keywords: fastai
sidebar: home_sidebar

summary: "API details. See docs for now."
description: "API details. See docs for now."
nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="validate_sigma" class="doc_header"><code>validate_sigma</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L40" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>validate_sigma</code>(<strong><code>sigma</code></strong>:<code>~SigmaType</code>, <strong><code>logger</code></strong>:<code>Optional</code>[<code>Logger</code>]=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="Notes:">Notes:<a class="anchor-link" href="#Notes:"> </a></h2>
<pre><code>- `sigma` (Gaussian kernel bandwidth)
    + `"std"`: standard deviation of the distances
    + `"knn"`: adaptive bandwidth, eg kth neighbor distance
    + `"minmax"`: min-max on the distance matrix
    + `"median"`: the median of the distances
    + `callable`: a function, f, such that f(d) returns a scalar or N-length vector
        where d is an NxN distance matrix
    + `scalar`: pre-computed bandwidth

</code></pre>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>sigma (str | Callable): The type of sigma function to use or a user defined function.
    Valid `sigma` values include `"minmax"`, `"median"`, `"std"`, `"knn"`. Defaults to
    `"knn"`.

logger (logging.Logger): The logger to which to log to. Defaults to `None`.

</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>None</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">VALID_SIGMAS</span> <span class="o">=</span> <span class="s1">&#39;minmax median std knn&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">SigmaType</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;SigmaType&#39;</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;minimax&quot;</span><span class="p">,</span> <span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;knn&quot;</span><span class="p">],</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate_sigma</span><span class="p">(</span>
    <span class="n">sigma</span><span class="p">:</span><span class="n">SigmaType</span><span class="p">,</span> 
    <span class="n">logger</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes:</span>
<span class="sd">    ---------</span>
<span class="sd">        - `sigma` (Gaussian kernel bandwidth)</span>
<span class="sd">            + `&quot;std&quot;`: standard deviation of the distances</span>
<span class="sd">            + `&quot;knn&quot;`: adaptive bandwidth, eg kth neighbor distance</span>
<span class="sd">            + `&quot;minmax&quot;`: min-max on the distance matrix</span>
<span class="sd">            + `&quot;median&quot;`: the median of the distances</span>
<span class="sd">            + `callable`: a function, f, such that f(d) returns a scalar or N-length vector</span>
<span class="sd">                where d is an NxN distance matrix</span>
<span class="sd">            + `scalar`: pre-computed bandwidth</span>

<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        sigma (str | Callable): The type of sigma function to use or a user defined function. </span>
<span class="sd">            Valid `sigma` values include `&quot;minmax&quot;`, `&quot;median&quot;`, `&quot;std&quot;`, `&quot;knn&quot;`. Defaults to </span>
<span class="sd">            `&quot;knn&quot;`.</span>
<span class="sd">            </span>
<span class="sd">        logger (logging.Logger): The logger to which to log to. Defaults to `None`.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">        None</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">is_known</span> <span class="o">=</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="n">VALID_SIGMAS</span> <span class="ow">or</span> <span class="n">callable</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span>
    <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;sigma (</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">) is </span><span class="si">{</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">is_known</span> <span class="k">else</span> <span class="s2">&quot;not &quot;</span><span class="si">}</span><span class="s1">known or callable.</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;known sigmas include </span><span class="si">{</span><span class="n">VALID_SIGMAS</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_known</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="gauss_kernel" class="doc_header"><code>gauss_kernel</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>gauss_kernel</code>(<strong><code>data1</code></strong>:<code>ndarray</code>, <strong><code>data2</code></strong>:<code>ndarray</code>, <strong><code>sigma</code></strong>:<code>~SigmaType</code>=<em><code>'knn'</code></em>, <strong><code>k</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>a</code></strong>:<code>int</code>=<em><code>2</code></em>, <strong><code>fac</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>logger</code></strong>:<code>Optional</code>[<code>Logger</code>]=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="Notes:">Notes:<a class="anchor-link" href="#Notes:"> </a></h2>
<pre><code>- Validated via points.csv file

- Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/gauss_kernel.m

- compute degree and sparsity estimates of data   https://arxiv.org/abs/1802.04927

- `sigma` (Gaussian kernel bandwidth)
    + `"std"`: standard deviation of the distances
    + `"knn"`: adaptive bandwidth, eg kth neighbor distance
    + `"minmax"`: min-max on the distance matrix
    + `"median"`: the median of the distances
    + `callable`: a function, f, such that f(d) returns a scalar or N-length vector
        where d is an NxN distance matrix
    + `scalar`: pre-computed bandwidth

- `a` (Alpha kernel decay)
    + `a=2` is Gaussian kernel

</code></pre>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>data1 (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.

data2 (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.

sigma (str | Callable): The type of sigma function to use or a user defined function.
    Valid `sigma` values include `"minmax"`, `"median"`, `"std"`, `"knn"`. Defaults to
    `"knn"`.

k (int): K-nearest neighbor distance to use if `sigma="knn"`. Defaults to `5`.

a (int): Alpha-kernel decay parameter. Defaults to `1`. Note `a=2` is the Gaussian
    kernel.

fac (int): Rescale kernel bandwidth. Defaults to `1`.

logger (logging.Logger): The logger to which to log to. Defaults to `None`.

</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>K (np.ndarray): kernel over data1, data2

sigma (np.ndarray): Nx1 (adaptive) or scalar (constant) estiamted kernel bandwidth</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">gauss_kernel</span><span class="p">(</span>
    <span class="n">data1</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">data2</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">sigma</span><span class="p">:</span><span class="n">SigmaType</span><span class="o">=</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">a</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">fac</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes:</span>
<span class="sd">    ---------</span>
<span class="sd">        - Validated via points.csv file</span>
<span class="sd">        </span>
<span class="sd">        - Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/gauss_kernel.m</span>

<span class="sd">        - compute degree and sparsity estimates of data   https://arxiv.org/abs/1802.04927</span>

<span class="sd">        - `sigma` (Gaussian kernel bandwidth)</span>
<span class="sd">            + `&quot;std&quot;`: standard deviation of the distances</span>
<span class="sd">            + `&quot;knn&quot;`: adaptive bandwidth, eg kth neighbor distance</span>
<span class="sd">            + `&quot;minmax&quot;`: min-max on the distance matrix</span>
<span class="sd">            + `&quot;median&quot;`: the median of the distances</span>
<span class="sd">            + `callable`: a function, f, such that f(d) returns a scalar or N-length vector</span>
<span class="sd">                where d is an NxN distance matrix</span>
<span class="sd">            + `scalar`: pre-computed bandwidth</span>
<span class="sd">        </span>
<span class="sd">        - `a` (Alpha kernel decay)</span>
<span class="sd">            + `a=2` is Gaussian kernel</span>

<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        data1 (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.</span>

<span class="sd">        data2 (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.</span>

<span class="sd">        sigma (str | Callable): The type of sigma function to use or a user defined function. </span>
<span class="sd">            Valid `sigma` values include `&quot;minmax&quot;`, `&quot;median&quot;`, `&quot;std&quot;`, `&quot;knn&quot;`. Defaults to </span>
<span class="sd">            `&quot;knn&quot;`.</span>
<span class="sd">        </span>
<span class="sd">        k (int): K-nearest neighbor distance to use if `sigma=&quot;knn&quot;`. Defaults to `5`.</span>

<span class="sd">        a (int): Alpha-kernel decay parameter. Defaults to `1`. Note `a=2` is the Gaussian</span>
<span class="sd">            kernel.</span>

<span class="sd">        fac (int): Rescale kernel bandwidth. Defaults to `1`.</span>

<span class="sd">        logger (logging.Logger): The logger to which to log to. Defaults to `None`.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">        K (np.ndarray): kernel over data1, data2</span>

<span class="sd">        sigma (np.ndarray): Nx1 (adaptive) or scalar (constant) estiamted kernel bandwidth</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">validate_sigma</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">logger</span><span class="p">)</span>
    
    <span class="n">D</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># print(np.round(D, 4)[:5, :5])</span>
    
    <span class="c1"># NOTE: validated with points.csv</span>
    <span class="k">if</span> <span class="n">sigma</span> <span class="o">==</span> <span class="s1">&#39;minmax&#39;</span><span class="p">:</span>
        <span class="n">min_dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">15</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">eps_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">min_dev</span><span class="p">)</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">eps_val</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>        

    <span class="c1"># NOTE: validated with points.csv</span>
    <span class="k">elif</span> <span class="n">sigma</span> <span class="o">==</span> <span class="s1">&#39;median&#39;</span><span class="p">:</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

    <span class="c1"># NOTE: validated with points.csv</span>
    <span class="k">elif</span> <span class="n">sigma</span> <span class="o">==</span> <span class="s1">&#39;std&#39;</span><span class="p">:</span>
        <span class="c1"># sigma = std(mean(D))</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
    <span class="c1"># NOTE: validated with points.csv</span>
    <span class="k">elif</span> <span class="n">sigma</span> <span class="o">==</span> <span class="s1">&#39;knn&#39;</span><span class="p">:</span>
        <span class="n">knn_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span>
        <span class="c1"># sigma = knn_dist(k+1,:);</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">knn_dist</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span>

    <span class="c1"># NOTE: validated with points.csv</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>

    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">sigma</span><span class="p">):</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">fac</span>
    
    <span class="c1"># K = bsxfun(@rdivide, D, sigma);</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="c1"># K = np.apply_along_axis(np.divide, 0, D, sigma)</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    
    <span class="n">K</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">K</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">K</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">K</span> <span class="o">&lt;</span> <span class="mf">1e-3</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">if</span> <span class="n">K</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">K</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">K</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    
    <span class="k">return</span> <span class="n">K</span><span class="p">,</span> <span class="n">sigma</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pnts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;points.csv&#39;</span><span class="p">),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">rnd_pnts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;random_points.csv&#39;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,)</span><span class="o">.</span><span class="n">values</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">K</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">gauss_kernel</span><span class="p">(</span><span class="n">pnts</span><span class="p">,</span> <span class="n">rnd_pnts</span><span class="p">,</span> <span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">K</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">sigma</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[0.        , 0.        , 0.00391327, 0.        , 0.        ],
        [0.97112778, 0.36787944, 0.34058866, 0.        , 0.        ],
        [0.        , 0.75845049, 0.89521196, 0.        , 0.        ],
        [0.        , 0.        , 0.00546059, 0.        , 0.        ],
        [0.        , 0.        , 0.        , 0.95346529, 0.        ]]),
 array([0.11821752, 0.24887548, 0.53853001, 0.07115662, 0.15531824,
        0.18688265, 0.13103245, 0.70869515, 0.29084548, 0.77155735,
        0.48030788, 0.0875428 , 0.94569724, 0.60007401, 0.21228984,
        0.35344204, 0.12498315, 0.11855851, 0.14912764, 0.08430752,
        0.21320032, 0.10458859, 0.12634235, 0.14870922, 0.87394288,
        0.48746408, 0.23136904, 0.29808207, 0.1621171 , 0.21642745,
        0.08490285, 0.12895623, 0.1078907 , 0.29769147, 0.26593868,
        0.08384001, 0.09196327, 0.24073227, 0.17551875, 0.05998292,
        0.08504684, 0.28296482, 0.05620995, 0.14385606, 0.15001278,
        0.06294853, 0.2429058 , 0.07863779, 0.15294187, 0.16144378,
        0.08492216, 0.11846428, 0.12218157]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">K</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">gauss_kernel</span><span class="p">(</span><span class="n">pnts</span><span class="p">,</span> <span class="n">pnts</span><span class="p">,</span> <span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">K</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">sigma</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[1.        , 0.        , 0.        , 0.7132805 , 0.        ],
        [0.        , 1.        , 0.18393972, 0.        , 0.        ],
        [0.        , 0.18393972, 1.        , 0.        , 0.        ],
        [0.7132805 , 0.        , 0.        , 1.        , 0.        ],
        [0.        , 0.        , 0.        , 0.        , 1.        ]]),
 array([0.09987109, 0.12998326, 0.37973647, 0.07036419, 0.08668946,
        0.14001442, 0.14816215, 0.14001442, 0.09798825, 0.1237121 ]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">data2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># data2=data1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="n">VALID_SIGMAS</span><span class="p">:</span>
    <span class="n">K</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">gauss_kernel</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;sigma=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="degrees" class="doc_header"><code>degrees</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L184" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>degrees</code>(<strong><code>data</code></strong>:<code>ndarray</code>, <strong><code>sigma</code></strong>:<code>~SigmaType</code>=<em><code>'std'</code></em>, <strong><code>k</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>a</code></strong>:<code>int</code>=<em><code>2</code></em>, <strong><code>fac</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>logger</code></strong>:<code>Optional</code>[<code>Logger</code>]=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="Notes:">Notes:<a class="anchor-link" href="#Notes:"> </a></h2>
<pre><code>- Validated via points.csv file

- Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/degrees.m

- compute degree and sparsity estimates of data   https://arxiv.org/abs/1802.04927

- `sigma` (Gaussian kernel bandwidth)
    + `"std"`: standard deviation of the distances
    + `"knn"`: adaptive bandwidth, eg kth neighbor distance
    + `"minmax"`: min-max on the distance matrix
    + `"median"`: the median of the distances
    + `callable`: a function, f, such that f(d) returns a scalar or N-length vector
        where d is an NxN distance matrix
    + `scalar`: pre-computed bandwidth

- `a` (Alpha kernel decay)
    + `a=2` is Gaussian kernel

</code></pre>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>data (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.


sigma (str | Callable): The type of sigma function to use or a user defined function.
    Valid `sigma` values include `"minmax"`, `"median"`, `"std"`, `"knn"`. Defaults to
    `"std"`.

k (int): K-nearest neighbor distance to use if `sigma="knn"`. Defaults to `5`.

a (int): Alpha-kernel decay parameter. Defaults to `1`. Note `a=2` is the Gaussian
    kernel.

fac (int): Rescale kernel bandwidth. Defaults to `1`.

logger (logging.Logger): The logger to which to log to. Defaults to `None`.

</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>d_hat (np.ndarray): N x 1 vector of the degree at each point in data of size N

s_hat (np.ndarray): N x 1 vector of the sparsity at each point,
    `s_hat=np.divide(1, d_hat)`

sigma (np.ndarray): Nx1 (adaptive) or scalar (constant) estiamted kernel bandwidth</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">degrees</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">sigma</span><span class="p">:</span><span class="n">SigmaType</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">a</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">fac</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes:</span>
<span class="sd">    ---------</span>
<span class="sd">        - Validated via points.csv file</span>

<span class="sd">        - Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/degrees.m</span>

<span class="sd">        - compute degree and sparsity estimates of data   https://arxiv.org/abs/1802.04927</span>

<span class="sd">        - `sigma` (Gaussian kernel bandwidth)</span>
<span class="sd">            + `&quot;std&quot;`: standard deviation of the distances</span>
<span class="sd">            + `&quot;knn&quot;`: adaptive bandwidth, eg kth neighbor distance</span>
<span class="sd">            + `&quot;minmax&quot;`: min-max on the distance matrix</span>
<span class="sd">            + `&quot;median&quot;`: the median of the distances</span>
<span class="sd">            + `callable`: a function, f, such that f(d) returns a scalar or N-length vector</span>
<span class="sd">                where d is an NxN distance matrix</span>
<span class="sd">            + `scalar`: pre-computed bandwidth</span>
<span class="sd">        </span>
<span class="sd">        - `a` (Alpha kernel decay)</span>
<span class="sd">            + `a=2` is Gaussian kernel</span>

<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        data (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.</span>


<span class="sd">        sigma (str | Callable): The type of sigma function to use or a user defined function. </span>
<span class="sd">            Valid `sigma` values include `&quot;minmax&quot;`, `&quot;median&quot;`, `&quot;std&quot;`, `&quot;knn&quot;`. Defaults to </span>
<span class="sd">            `&quot;std&quot;`.</span>
<span class="sd">        </span>
<span class="sd">        k (int): K-nearest neighbor distance to use if `sigma=&quot;knn&quot;`. Defaults to `5`.</span>

<span class="sd">        a (int): Alpha-kernel decay parameter. Defaults to `1`. Note `a=2` is the Gaussian</span>
<span class="sd">            kernel.</span>

<span class="sd">        fac (int): Rescale kernel bandwidth. Defaults to `1`.</span>

<span class="sd">        logger (logging.Logger): The logger to which to log to. Defaults to `None`.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">        d_hat (np.ndarray): N x 1 vector of the degree at each point in data of size N</span>

<span class="sd">        s_hat (np.ndarray): N x 1 vector of the sparsity at each point, </span>
<span class="sd">            `s_hat=np.divide(1, d_hat)`</span>
<span class="sd">        </span>
<span class="sd">        sigma (np.ndarray): Nx1 (adaptive) or scalar (constant) estiamted kernel bandwidth</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">validate_sigma</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">logger</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">K</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">gauss_kernel</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">fac</span><span class="o">=</span><span class="n">fac</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
    <span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">d_hat</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">s_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">d_hat</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d_hat</span><span class="p">,</span> <span class="n">s_hat</span><span class="p">,</span> <span class="n">sigma</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">degrees</span><span class="p">(</span><span class="n">pnts</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([0.0232194 , 0.01366118, 0.00296261, 0.02374361, 0.01619097,
        0.01638025, 0.01337635, 0.02022532, 0.02639145, 0.02372243,
        0.03391127, 0.01315071, 0.03394528, 0.03058909, 0.0218781 ,
        0.02267789, 0.02238982, 0.00341027, 0.00252961, 0.01624739,
        0.02322763, 0.0233943 , 0.00326422, 0.01259218, 0.00851955,
        0.01849438, 0.02108075, 0.01924706, 0.02372026, 0.01779681,
        0.01632197, 0.02953699, 0.01374419, 0.03345346, 0.01321157,
        0.02851005, 0.01984902, 0.03084948, 0.03391855, 0.02068446,
        0.01644617, 0.03352726, 0.02494909, 0.00331068, 0.02134958,
        0.03384447, 0.00760993, 0.00861353, 0.02383809, 0.02036809,
        0.02660306, 0.0255901 , 0.01668932, 0.0134559 , 0.01837106,
        0.01332942, 0.02059994, 0.02531346, 0.02325324, 0.0208165 ,
        0.02344518, 0.02555666, 0.0329378 , 0.02315835, 0.01297086,
        0.00999624, 0.00886615, 0.01941506, 0.01366177, 0.00844297,
        0.03205047, 0.02435234, 0.027467  , 0.02559419, 0.03190258,
        0.03394753, 0.0126226 , 0.0164056 , 0.01624739, 0.00870302,
        0.02439684, 0.01613691, 0.01606652, 0.02530954, 0.0271946 ,
        0.02002133, 0.01315266, 0.01349499, 0.0255792 , 0.02463929,
        0.01107903, 0.03391973, 0.02275449, 0.02317268, 0.01601047,
        0.01818579, 0.01582495, 0.01954898, 0.01777067, 0.01809878]),
 array([ 43.06742812,  73.20009916, 337.54064013,  42.11659248,
         61.76281079,  61.04912168,  74.75880093,  49.44297936,
         37.8910603 ,  42.15419403,  29.48871758,  76.0415287 ,
         29.45917525,  32.69139385,  45.70780811,  44.09581085,
         44.66316448, 293.2323214 , 395.31765012,  61.54835381,
         43.05218205,  42.74545187, 306.35168061,  79.41435493,
        117.37715848,  54.07047774,  47.43665221,  51.95599115,
         42.15805572,  56.18985898,  61.26711708,  33.85585049,
         72.75802893,  29.89227379,  75.69125557,  35.07535623,
         50.38031482,  32.41545699,  29.48239072,  48.3454789 ,
         60.80444106,  29.82647529,  40.08162432, 302.05231866,
         46.83931798,  29.54692098, 131.40718042, 116.09636573,
         41.9496639 ,  49.09641243,  37.5896546 ,  39.07760785,
         59.91855172,  74.31686651,  54.43343637,  75.02203532,
         48.54383967,  39.50466758,  43.00476403,  48.03882484,
         42.65268991,  39.12874584,  30.36025628,  43.18096091,
         77.09586807, 100.03762779, 112.78854894,  51.50640008,
         73.19697609, 118.4417783 ,  31.2007888 ,  41.06382287,
         36.40732059,  39.07136804,  31.34542267,  29.45722074,
         79.22298209,  60.95480273,  61.54835381, 114.90259097,
         40.98891427,  61.96973148,  62.24121332,  39.51079134,
         36.77200938,  49.94672629,  76.03023935,  74.10156119,
         39.09427067,  40.58558138,  90.26064949,  29.48136649,
         43.947363  ,  43.15425941,  62.45911837,  54.98799187,
         63.19137139,  51.1535671 ,  56.2724951 ,  55.25234019]),
 0.21378502556158857)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">degrees</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([1., 1., 1., 1., 1.]), array([1., 1., 1., 1., 1.]), 4.183300132670378)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="local_covariance" class="doc_header"><code>local_covariance</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L251" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>local_covariance</code>(<strong><code>data</code></strong>:<code>ndarray</code>, <strong><code>k</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>logger</code></strong>:<code>Optional</code>[<code>Logger</code>]=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="Notes:">Notes:<a class="anchor-link" href="#Notes:"> </a></h2>
<pre><code>- Validated with points.csv

- Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/local_covariance.m

</code></pre>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>data (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.


sigma (str | Callable): The type of sigma function to use or a user defined function.
    Valid `sigma` values include `"minmax"`, `"median"`, `"std"`, `"knn"`. Defaults to
    `"std"`.

k (int): K-nearest neighbor distance to use if `sigma="knn"`. Defaults to `5`.

logger (logging.Logger): The logger to which to log to. Defaults to `None`.

</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>local_cov (np.ndarray):  N-length cell of local covariance matrices of the Gaussian
    generated noise.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">local_covariance</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes:</span>
<span class="sd">    ---------</span>
<span class="sd">        - Validated with points.csv</span>
<span class="sd">        </span>
<span class="sd">        - Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/local_covariance.m</span>

<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        data (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.</span>


<span class="sd">        sigma (str | Callable): The type of sigma function to use or a user defined function. </span>
<span class="sd">            Valid `sigma` values include `&quot;minmax&quot;`, `&quot;median&quot;`, `&quot;std&quot;`, `&quot;knn&quot;`. Defaults to </span>
<span class="sd">            `&quot;std&quot;`.</span>
<span class="sd">        </span>
<span class="sd">        k (int): K-nearest neighbor distance to use if `sigma=&quot;knn&quot;`. Defaults to `5`.</span>

<span class="sd">        logger (logging.Logger): The logger to which to log to. Defaults to `None`.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">        local_cov (np.ndarray):  N-length cell of local covariance matrices of the Gaussian</span>
<span class="sd">            generated noise. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">local_cov</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">neigh</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">neigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>    
        <span class="n">idx</span> <span class="o">=</span> <span class="n">neigh</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">return_distance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">:]</span>
        <span class="n">local_cov</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">rowvar</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">local_cov</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">local_covariance</span><span class="p">(</span><span class="n">pnts</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[[ 1.41202391e-03,  4.33863408e-04],
        [ 4.33863408e-04,  1.33544229e-04]],

       [[ 1.09934026e-03, -5.96880448e-04],
        [-5.96880448e-04,  3.24330087e-04]],

       [[ 1.52697277e-02, -1.15356081e-02],
        [-1.15356081e-02,  8.75111087e-03]],

       [[ 1.41202391e-03,  4.33863408e-04],
        [ 4.33863408e-04,  1.33544229e-04]],

       [[ 9.64207080e-04, -4.62324260e-04],
        [-4.62324260e-04,  2.21791583e-04]],

       [[ 9.05869617e-05,  8.25870282e-04],
        [ 8.25870282e-04,  9.00293104e-03]],

       [[ 1.09934026e-03, -5.96880448e-04],
        [-5.96880448e-04,  3.24330087e-04]],

       [[ 6.40960031e-03,  5.00768749e-03],
        [ 5.00768749e-03,  3.93175190e-03]],

       [[ 1.98336858e-04,  4.65469608e-04],
        [ 4.65469608e-04,  1.09492791e-03]],

       [[ 1.62730628e-03,  1.49884579e-03],
        [ 1.49884579e-03,  1.38273114e-03]],

       [[ 3.50843082e-05,  4.83765081e-05],
        [ 4.83765081e-05,  6.67073842e-05]],

       [[ 1.09934026e-03, -5.96880448e-04],
        [-5.96880448e-04,  3.24330087e-04]],

       [[ 3.50843082e-05,  4.83765081e-05],
        [ 4.83765081e-05,  6.67073842e-05]],

       [[ 9.92806518e-04,  1.83279074e-03],
        [ 1.83279074e-03,  3.40108037e-03]],

       [[ 2.31502746e-04,  7.94536724e-04],
        [ 7.94536724e-04,  2.74258993e-03]],

       [[ 2.76720526e-04, -5.29237568e-04],
        [-5.29237568e-04,  1.01306678e-03]],

       [[ 3.03565112e-04,  9.46518940e-04],
        [ 9.46518940e-04,  2.96987778e-03]],

       [[ 4.97605891e-02,  2.84016196e-02],
        [ 2.84016196e-02,  1.66876465e-02]],

       [[ 4.97605891e-02,  2.84016196e-02],
        [ 2.84016196e-02,  1.66876465e-02]],

       [[ 4.03301956e-04, -1.85735755e-04],
        [-1.85735755e-04,  8.55632473e-05]],

       [[ 3.36402167e-04, -1.09480277e-03],
        [-1.09480277e-03,  3.58842853e-03]],

       [[ 1.41202391e-03,  4.33863408e-04],
        [ 4.33863408e-04,  1.33544229e-04]],

       [[ 3.59725151e-02, -3.72227486e-02],
        [-3.72227486e-02,  3.53092905e-01]],

       [[ 4.32662020e-03, -3.87509114e-03],
        [-3.87509114e-03,  3.48351657e-03]],

       [[ 1.63953073e-02,  2.18872476e-03],
        [ 2.18872476e-03,  3.30278958e-04]],

       [[ 7.30449360e-05, -5.38378818e-04],
        [-5.38378818e-04,  4.28307825e-03]],

       [[ 3.07500364e-04, -1.40658430e-03],
        [-1.40658430e-03,  6.51094741e-03]],

       [[ 2.37217246e-04,  1.10053143e-03],
        [ 1.10053143e-03,  5.20868884e-03]],

       [[ 2.22523775e-03,  5.23319333e-04],
        [ 5.23319333e-04,  1.23898076e-04]],

       [[ 7.30449360e-05, -5.38378818e-04],
        [-5.38378818e-04,  4.28307825e-03]],

       [[ 4.03301956e-04, -1.85735755e-04],
        [-1.85735755e-04,  8.55632473e-05]],

       [[ 6.55725114e-04,  7.06975794e-04],
        [ 7.06975794e-04,  7.62447137e-04]],

       [[ 8.11777960e-03, -5.90201259e-03],
        [-5.90201259e-03,  4.32931358e-03]],

       [[ 8.14263869e-05,  1.18738039e-04],
        [ 1.18738039e-04,  1.73155122e-04]],

       [[ 8.84909335e-03, -3.28112949e-03],
        [-3.28112949e-03,  1.22448120e-03]],

       [[ 4.67134908e-04,  9.59743823e-04],
        [ 9.59743823e-04,  1.97347666e-03]],

       [[ 2.37217246e-04,  1.10053143e-03],
        [ 1.10053143e-03,  5.20868884e-03]],

       [[ 9.92806518e-04,  1.83279074e-03],
        [ 1.83279074e-03,  3.40108037e-03]],

       [[ 6.68672425e-05,  9.13880811e-05],
        [ 9.13880811e-05,  1.24906784e-04]],

       [[ 1.29767181e-03,  6.92799800e-04],
        [ 6.92799800e-04,  3.70316689e-04]],

       [[ 1.73650421e-05, -2.66863213e-04],
        [-2.66863213e-04,  4.44307729e-03]],

       [[ 3.19151075e-04,  3.99588342e-04],
        [ 3.99588342e-04,  5.00494446e-04]],

       [[ 2.53524807e-04, -5.42494869e-04],
        [-5.42494869e-04,  1.16342251e-03]],

       [[ 5.84865303e-02, -7.67101978e-02],
        [-7.67101978e-02,  1.05685791e-01]],

       [[ 2.76720526e-04, -5.29237568e-04],
        [-5.29237568e-04,  1.01306678e-03]],

       [[ 1.33013436e-04,  1.77845133e-04],
        [ 1.77845133e-04,  2.37837616e-04]],

       [[ 2.32612801e-02,  8.89381755e-03],
        [ 8.89381755e-03,  3.52274123e-03]],

       [[ 1.63953073e-02,  2.18872476e-03],
        [ 2.18872476e-03,  3.30278958e-04]],

       [[ 2.77701779e-03,  7.39187184e-04],
        [ 7.39187184e-04,  1.98001582e-04]],

       [[ 1.28579322e-03,  1.82374774e-05],
        [ 1.82374774e-05,  3.82102453e-07]],

       [[ 1.98336858e-04,  4.65469608e-04],
        [ 4.65469608e-04,  1.09492791e-03]],

       [[ 9.11035181e-05, -2.22309900e-04],
        [-2.22309900e-04,  5.43176951e-04]],

       [[ 1.46628836e-04,  1.04440085e-03],
        [ 1.04440085e-03,  7.84955335e-03]],

       [[ 8.84909335e-03, -3.28112949e-03],
        [-3.28112949e-03,  1.22448120e-03]],

       [[ 2.23639886e-03, -3.21930296e-05],
        [-3.21930296e-05,  1.33842348e-06]],

       [[ 1.09934026e-03, -5.96880448e-04],
        [-5.96880448e-04,  3.24330087e-04]],

       [[ 1.28579322e-03,  1.82374774e-05],
        [ 1.82374774e-05,  3.82102453e-07]],

       [[ 1.55258039e-04, -3.52468952e-04],
        [-3.52468952e-04,  8.00521767e-04]],

       [[ 2.76720526e-04, -5.29237568e-04],
        [-5.29237568e-04,  1.01306678e-03]],

       [[ 2.54299681e-03,  1.10553465e-03],
        [ 1.10553465e-03,  4.81972088e-04]],

       [[ 1.70320008e-03,  3.41522880e-04],
        [ 3.41522880e-04,  6.89434065e-05]],

       [[ 9.11035181e-05, -2.22309900e-04],
        [-2.22309900e-04,  5.43176951e-04]],

       [[ 3.05115086e-04,  3.76275314e-04],
        [ 3.76275314e-04,  4.64175195e-04]],

       [[ 1.41202391e-03,  4.33863408e-04],
        [ 4.33863408e-04,  1.33544229e-04]],

       [[ 1.59523817e-02, -2.72738125e-03],
        [-2.72738125e-03,  4.79832901e-04]],

       [[ 2.21145698e-02, -4.81757696e-03],
        [-4.81757696e-03,  1.11120679e-03]],

       [[ 2.53004439e-02, -2.08627141e-03],
        [-2.08627141e-03,  3.12845445e-04]],

       [[ 1.29767181e-03,  6.92799800e-04],
        [ 6.92799800e-04,  3.70316689e-04]],

       [[ 2.16859575e-03, -8.06497593e-04],
        [-8.06497593e-04,  3.00064655e-04]],

       [[ 2.62524700e-02,  9.09276955e-04],
        [ 9.09276955e-04,  1.03614073e-04]],

       [[ 4.52476745e-04,  5.25226117e-04],
        [ 5.25226117e-04,  6.10224259e-04]],

       [[ 2.16973099e-04, -6.32178424e-04],
        [-6.32178424e-04,  1.84553961e-03]],

       [[ 1.01897703e-03,  1.04236390e-03],
        [ 1.04236390e-03,  1.06828143e-03]],

       [[ 9.11035181e-05, -2.22309900e-04],
        [-2.22309900e-04,  5.43176951e-04]],

       [[ 4.52476745e-04,  5.25226117e-04],
        [ 5.25226117e-04,  6.10224259e-04]],

       [[ 3.50843082e-05,  4.83765081e-05],
        [ 4.83765081e-05,  6.67073842e-05]],

       [[ 4.32662020e-03, -3.87509114e-03],
        [-3.87509114e-03,  3.48351657e-03]],

       [[ 9.64207080e-04, -4.62324260e-04],
        [-4.62324260e-04,  2.21791583e-04]],

       [[ 4.03301956e-04, -1.85735755e-04],
        [-1.85735755e-04,  8.55632473e-05]],

       [[ 1.63953073e-02,  2.18872476e-03],
        [ 2.18872476e-03,  3.30278958e-04]],

       [[ 2.18262797e-04,  5.89692854e-04],
        [ 5.89692854e-04,  1.59630839e-03]],

       [[ 4.03301956e-04, -1.85735755e-04],
        [-1.85735755e-04,  8.55632473e-05]],

       [[ 9.33625465e-06,  5.29494035e-05],
        [ 5.29494035e-05,  8.51486673e-03]],

       [[ 1.14479098e-04, -3.15635390e-04],
        [-3.15635390e-04,  8.71027186e-04]],

       [[ 1.01897703e-03,  1.04236390e-03],
        [ 1.04236390e-03,  1.06828143e-03]],

       [[ 1.29767181e-03,  6.92799800e-04],
        [ 6.92799800e-04,  3.70316689e-04]],

       [[ 5.74112766e-03, -5.80746149e-03],
        [-5.80746149e-03,  5.92966835e-03]],

       [[ 8.11777960e-03, -5.90201259e-03],
        [-5.90201259e-03,  4.32931358e-03]],

       [[ 1.98336858e-04,  4.65469608e-04],
        [ 4.65469608e-04,  1.09492791e-03]],

       [[ 2.17616103e-04, -4.36111375e-04],
        [-4.36111375e-04,  8.74497235e-04]],

       [[ 1.09934026e-03, -5.96880448e-04],
        [-5.96880448e-04,  3.24330087e-04]],

       [[ 3.50843082e-05,  4.83765081e-05],
        [ 4.83765081e-05,  6.67073842e-05]],

       [[ 3.95951887e-03,  5.33523986e-04],
        [ 5.33523986e-04,  7.45516454e-05]],

       [[ 1.70320008e-03,  3.41522880e-04],
        [ 3.41522880e-04,  6.89434065e-05]],

       [[ 2.23639886e-03, -3.21930296e-05],
        [-3.21930296e-05,  1.33842348e-06]],

       [[ 1.29767181e-03,  6.92799800e-04],
        [ 6.92799800e-04,  3.70316689e-04]],

       [[ 3.40935350e-03, -4.91709368e-03],
        [-4.91709368e-03,  7.11756913e-03]],

       [[ 1.28579322e-03,  1.82374774e-05],
        [ 1.82374774e-05,  3.82102453e-07]],

       [[ 2.23639886e-03, -3.21930296e-05],
        [-3.21930296e-05,  1.33842348e-06]],

       [[ 7.30449360e-05, -5.38378818e-04],
        [-5.38378818e-04,  4.28307825e-03]]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data1</span><span class="p">,</span> <span class="n">local_covariance</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[ 0,  1,  2,  3,  4],
        [ 5,  6,  7,  8,  9],
        [10, 11, 12, 13, 14],
        [15, 16, 17, 18, 19],
        [20, 21, 22, 23, 24]]),
 array([[[62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5]],
 
        [[62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5]],
 
        [[62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5]],
 
        [[62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5]],
 
        [[62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5],
         [62.5, 62.5, 62.5, 62.5, 62.5]]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data2</span><span class="p">,</span> <span class="n">local_covariance</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[0., 1., 0., 0., 0.],
        [0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0.]]),
 array([[[0. , 0. , 0. , 0. , 0. ],
         [0. , 0.2, 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ]],
 
        [[0. , 0. , 0. , 0. , 0. ],
         [0. , 0.2, 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ]],
 
        [[0. , 0. , 0. , 0. , 0. ],
         [0. , 0.2, 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ]],
 
        [[0. , 0. , 0. , 0. , 0. ],
         [0. , 0.2, 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ]],
 
        [[0. , 0. , 0. , 0. , 0. ],
         [0. , 0.2, 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ],
         [0. , 0. , 0. , 0. , 0. ]]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="feature_scale" class="doc_header"><code>feature_scale</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L291" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>feature_scale</code>(<strong><code>x</code></strong>:<code>ndarray</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">feature_scale</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">fp</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="numpts" class="doc_header"><code>numpts</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L296" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>numpts</code>(<strong><code>degree</code></strong>:<code>ndarray</code>, <strong><code>noise_cov</code></strong>:<code>Union</code>[<code>int</code>, <code>float</code>, <code>ndarray</code>]=<em><code>1</code></em>, <strong><code>kernel_sigma</code></strong>:<code>Union</code>[<code>int</code>, <code>float</code>, <code>ndarray</code>]=<em><code>1</code></em>, <strong><code>dim</code></strong>:<code>Union</code>[<code>int</code>, Literal[None]<code>\]=*</code>None<code>*, **</code>M<code>**:</code>int<code>=*</code>0<code>*, **</code>equalize<code>**:</code>bool<code>=*</code>False<code>*, **</code>suppress<code>**:</code>bool<code>=*</code>False<code>*, **</code>logger<code>**:</code>Optional<code>\[</code>Logger<code>\]=*</code>None`*)</p>
</blockquote>
<h2 id="Notes:">Notes:<a class="anchor-link" href="#Notes:"> </a></h2>
<pre><code>- Validated with points.csv

- Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/numpts.m

- compute the number of new points to generate around each point in a
    dataset https://arxiv.org/abs/1802.04927

- `M` (number of points to generate)
    + `M and equalize`: then density equalization will be scaled by `M`. `M &lt; N`
        will negatively impact density equalization, `M &lt;&lt; N` is not recommended
        and `M &lt;&lt;&lt; N` may fail.

    + `not M and equalize`: then density equalization will not be scaled.

    + `M and not equalize`: then approximately `M` points will be generated
        according to a constant difference of max density.

    + `not M and not equalize`: then `M` is approximately N points.

</code></pre>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>degree (np.ndarray): Degree estimate of the N x D data in shape N x 1.


noise_cov (int|float|np.ndarray): Noise bandwidth used for downstream data generation.
    Accepts a scalar for a unifrom Gaussian noise variance or an array
    containing D x D local covariance matricies for Gaussian generated noise.
    Defaults to `1`.

kernel_sigma (int|float|np.ndarray): Degree estimate bandwith. A scalar for uniform
    bandwidth or an N x 1 array for adaptive bandwidth. Defaults to `1`.

dim (int): Generated noise dimension. Defaults to `D` if availible from
    `noise_cov` else required.

M (int): Number of points to generate. Can affect strength of density equalization.
    Can accept positive scalars. Defaults to `0`.

equalize (bool): Density equalization. Can be affected by `M` (see notes). Defaults
    to `False`.

suppress (bool): Enabled / disable point generation errors. Defaults to `False`.
    Deprecated.

logger (logging.Logger): The logger to which to log to. Defaults to `None`.

</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>npts (np.ndarray): The number of points to generate at each point</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">numpts</span><span class="p">(</span>
    <span class="n">degree</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">noise_cov</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">kernel_sigma</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">dim</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">M</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">equalize</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes:</span>
<span class="sd">    ---------</span>
<span class="sd">        - Validated with points.csv</span>
<span class="sd">        </span>
<span class="sd">        - Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/numpts.m</span>

<span class="sd">        - compute the number of new points to generate around each point in a </span>
<span class="sd">            dataset https://arxiv.org/abs/1802.04927</span>

<span class="sd">        - `M` (number of points to generate)</span>
<span class="sd">            + `M and equalize`: then density equalization will be scaled by `M`. `M &lt; N`</span>
<span class="sd">                will negatively impact density equalization, `M &lt;&lt; N` is not recommended</span>
<span class="sd">                and `M &lt;&lt;&lt; N` may fail.</span>

<span class="sd">            + `not M and equalize`: then density equalization will not be scaled.</span>
<span class="sd">            </span>
<span class="sd">            + `M and not equalize`: then approximately `M` points will be generated</span>
<span class="sd">                according to a constant difference of max density.</span>
<span class="sd">            </span>
<span class="sd">            + `not M and not equalize`: then `M` is approximately N points.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        degree (np.ndarray): Degree estimate of the N x D data in shape N x 1.</span>


<span class="sd">        noise_cov (int|float|np.ndarray): Noise bandwidth used for downstream data generation. </span>
<span class="sd">            Accepts a scalar for a unifrom Gaussian noise variance or an array </span>
<span class="sd">            containing D x D local covariance matricies for Gaussian generated noise.</span>
<span class="sd">            Defaults to `1`.</span>
<span class="sd">        </span>
<span class="sd">        kernel_sigma (int|float|np.ndarray): Degree estimate bandwith. A scalar for uniform</span>
<span class="sd">            bandwidth or an N x 1 array for adaptive bandwidth. Defaults to `1`.</span>
<span class="sd">        </span>
<span class="sd">        dim (int): Generated noise dimension. Defaults to `D` if availible from </span>
<span class="sd">            `noise_cov` else required. </span>

<span class="sd">        M (int): Number of points to generate. Can affect strength of density equalization.</span>
<span class="sd">            Can accept positive scalars. Defaults to `0`.</span>

<span class="sd">        equalize (bool): Density equalization. Can be affected by `M` (see notes). Defaults</span>
<span class="sd">            to `False`.</span>

<span class="sd">        suppress (bool): Enabled / disable point generation errors. Defaults to `False`.</span>
<span class="sd">            Deprecated.</span>

<span class="sd">        logger (logging.Logger): The logger to which to log to. Defaults to `None`.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">        npts (np.ndarray): The number of points to generate at each point</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">degree</span><span class="p">)</span>
    <span class="n">const</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">degree</span><span class="p">)</span>
    <span class="n">number_estimate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># NOTE: validated with points.csv</span>
    <span class="k">if</span> <span class="n">equalize</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">noise_cov</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Density equalizaton according to scalar noise covariance...&#39;</span><span class="p">)</span>
            <span class="n">number_estimate</span> <span class="o">=</span> <span class="p">(</span><span class="n">const</span> <span class="o">-</span> <span class="n">degree</span><span class="p">)</span> <span class="o">*</span> \
                <span class="p">(</span> <span class="p">(</span><span class="n">kernel_sigma</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">noise_cov</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">noise_cov</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">dim</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Density equalizaton according to local noise covariance...&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kernel_sigma</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                    <span class="n">sig</span> <span class="o">=</span> <span class="n">kernel_sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sig</span> <span class="o">=</span> <span class="n">kernel_sigma</span>

                <span class="n">number_estimate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">const</span> <span class="o">-</span> <span class="n">degree</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span> 
                        <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="o">*</span><span class="n">noise_cov</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">noise_cov</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span> 
                    <span class="p">),</span> <span class="mf">0.5</span><span class="p">)</span>
            
        <span class="c1"># NOTE: validated with points.csv        </span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Applying total generation constraint M.&#39;</span><span class="p">)</span>
            <span class="n">number_save</span> <span class="o">=</span> <span class="n">number_estimate</span>
            <span class="n">number_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">number_estimate</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">M</span> <span class="o">/</span> <span class="n">number_sum</span> <span class="o">&lt;</span> <span class="mf">1e-1</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">M</span> <span class="o">/</span> <span class="n">number_sum</span> <span class="o">*</span> <span class="mi">100</span><span class="si">}</span><span class="s1">% of equalized total. &#39;</span>
                    <span class="s1">&#39;Output will reflecct equalization. Increased M suggested.&#39;</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="n">number_estimate</span> <span class="o">=</span> <span class="p">(</span><span class="n">number_estimate</span> <span class="o">*</span> <span class="n">M</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">number_estimate</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-17</span><span class="p">)</span>
            <span class="n">npts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">number_estimate</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">npts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">number_estimate</span><span class="p">)</span>
    
    <span class="c1"># NOTE: validated with points.csv            </span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Generating without density equalization&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;No M supplied, M = N&#39;</span><span class="p">)</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">N</span>

        <span class="n">number_estimate</span> <span class="o">=</span> <span class="p">(</span><span class="n">const</span> <span class="o">-</span> <span class="n">degree</span><span class="p">)</span>
        <span class="n">number_estimate</span> <span class="o">=</span> <span class="p">(</span><span class="n">number_estimate</span> <span class="o">*</span> <span class="n">M</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">number_estimate</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-17</span><span class="p">)</span>

        <span class="n">npts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">number_estimate</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Point generation estimate &lt; 0, either provide/increase M or decrease noise_cov.&#39;</span><span class="p">)</span>
        <span class="n">npts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">npts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="p">))</span>

    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">npts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Point generation estimate &gt; 1e4, either provide/decrease M or increase noise_cov.&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">npts</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d_hat</span><span class="p">,</span> <span class="n">s_hat</span><span class="p">,</span> <span class="n">degree_sigma</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">pnts</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">noise</span> <span class="o">=</span> <span class="n">local_covariance</span><span class="p">(</span><span class="n">pnts</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">noise_cov</span> <span class="o">=</span> <span class="n">noise</span>
    
<span class="n">npts</span> <span class="o">=</span> <span class="n">numpts</span><span class="p">(</span>
    <span class="n">d_hat</span><span class="p">,</span> <span class="n">noise_cov</span><span class="o">=</span><span class="n">noise_cov</span><span class="p">,</span> <span class="n">kernel_sigma</span><span class="o">=</span><span class="n">degree_sigma</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">equalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">npts</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0., 1., 2., 0., 1., 1., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
       2., 2., 1., 0., 0., 2., 1., 1., 1., 0., 1., 0., 1., 1., 0., 1., 0.,
       1., 0., 1., 0., 0., 0., 1., 0., 0., 2., 0., 0., 1., 1., 0., 0., 0.,
       0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 1., 1., 1.,
       1., 1., 0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 1., 1., 0., 0.,
       0., 1., 1., 0., 0., 1., 0., 0., 0., 1., 1., 1., 1., 1., 1.])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate" class="doc_header"><code>generate</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L422" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate</code>(<strong><code>data</code></strong>:<code>ndarray</code>, <strong><code>npts</code></strong>:<code>ndarray</code>, <strong><code>noise_cov</code></strong>:<code>Union</code>[<code>int</code>, <code>float</code>, <code>ndarray</code>], <strong><code>labels</code></strong>:<code>list</code>, <strong><code>logger</code></strong>:<code>Optional</code>[<code>Logger</code>]=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="Notes:">Notes:<a class="anchor-link" href="#Notes:"> </a></h2>
<pre><code>- Validated with points.csv

- Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/generate.m

- compute the number of new points to generate around each point in a
    dataset https://arxiv.org/abs/1802.04927

</code></pre>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>data (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.


npts (np.ndarray): Number of points to generate around each point in data,
    with shape N x 1.

noise_cov (int|float|np.ndarray): Noise bandwidth used for downstream data generation.
    Accepts a scalar for a unifrom Gaussian noise variance or an array
    containing D x D local covariance matricies for Gaussian generated noise.

labels (list): Labels to add to new points

logger (logging.Logger): The logger to which to log to. Defaults to `None`.

</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>random_points (np.ndarray): Noisy generated points with shape `np.sum(npts) x D`.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">npts</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">noise_cov</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> 
    <span class="n">labels</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes:</span>
<span class="sd">    ---------</span>
<span class="sd">        - Validated with points.csv</span>

<span class="sd">        - Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/generate.m</span>

<span class="sd">        - compute the number of new points to generate around each point in a </span>
<span class="sd">            dataset https://arxiv.org/abs/1802.04927</span>

<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        data (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.</span>


<span class="sd">        npts (np.ndarray): Number of points to generate around each point in data,</span>
<span class="sd">            with shape N x 1.</span>
<span class="sd">           </span>
<span class="sd">        noise_cov (int|float|np.ndarray): Noise bandwidth used for downstream data generation. </span>
<span class="sd">            Accepts a scalar for a unifrom Gaussian noise variance or an array </span>
<span class="sd">            containing D x D local covariance matricies for Gaussian generated noise.</span>
<span class="sd">                    </span>
<span class="sd">        labels (list): Labels to add to new points</span>

<span class="sd">        logger (logging.Logger): The logger to which to log to. Defaults to `None`.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">        random_points (np.ndarray): Noisy generated points with shape `np.sum(npts) x D`.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    

    <span class="n">rep_centers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">rep_cov</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">labels_out</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="n">npts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">noise_cov</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span> <span class="c1"># constant cov, no need to replicate cov.</span>
        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Constant covariance, no need to replicate covariance&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="c1"># replicate data[i] to make npts[i] centers for mvnrnd</span>
            <span class="n">new_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="p">(</span><span class="n">npts</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">rep_centers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_center</span><span class="p">)</span><span class="c1"># = [rep_centers, new_center]</span>
            <span class="k">if</span> <span class="n">labels</span><span class="p">:</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">npts</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">labels_out</span> <span class="o">=</span> <span class="p">[</span><span class="n">labels_out</span><span class="p">,</span> <span class="n">new_labels</span><span class="p">]</span>
        <span class="c1"># generate</span>
        <span class="n">random_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span>
            <span class="n">rep_centers</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">noise_cov</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="c1"># replicate centers npts[i] times</span>
            <span class="n">new_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">labels</span><span class="p">:</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">npts</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">labels_out</span> <span class="o">=</span> <span class="p">[</span><span class="n">labels_out</span><span class="p">,</span> <span class="n">new_labels</span><span class="p">]</span>
            
            <span class="c1"># rep_centers = [rep_centers, new_center]</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">new_center</span><span class="p">):</span>
                <span class="n">rep_centers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_center</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">npts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># replicate the covariance matrix   </span>
                <span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">noise_cov</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">npts</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">noise_cov</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="n">rep_cov</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span> 
                

        <span class="n">rep_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">rep_cov</span><span class="p">)</span>
        <span class="n">rep_centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">rep_centers</span><span class="p">)</span>


        <span class="n">random_points</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rep_centers</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
            <span class="n">random_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">rep_cov</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="p">)</span>
        
        <span class="n">random_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">random_points</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">random_points</span><span class="p">,</span> <span class="n">labels_out</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnpts</span><span class="p">,</span> <span class="n">labels_out</span> <span class="o">=</span> <span class="n">generate</span><span class="p">(</span><span class="n">pnts</span><span class="p">,</span> <span class="n">npts</span><span class="p">,</span> <span class="n">noise_cov</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[])</span> 
<span class="n">rnpts</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/tmp/ipykernel_40939/1440296221.py:101: RuntimeWarning: covariance is not positive-semidefinite.
  np.random.multivariate_normal(row, rep_cov[i])
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[-0.48566533, -0.87264071],
       [-0.74032607, -0.67393248],
       [-0.67547087, -0.72311697],
       [ 0.51420741,  0.86150587],
       [ 1.00120668, -0.07028511]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="matlab_percentile" class="doc_header"><code>matlab_percentile</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L514" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>matlab_percentile</code>(<strong><code>in_data</code></strong>, <strong><code>percentiles</code></strong>)</p>
</blockquote>
<p>Calculate percentiles in the way IDL and Matlab do it.</p>
<p>By using interpolation between the lowest an highest rank and the
minimum and maximum outside.</p>
<p>Notes:</p>

<pre><code>- shamelessly yoinked from https://github.com/numpy/numpy/issues/6620

</code></pre>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>in_data: numpy.ndarray
    input data
percentiles: numpy.ndarray
    percentiles at which to calculate the values</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>perc: numpy.ndarray
    values of the percentiles</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">matlab_percentile</span><span class="p">(</span><span class="n">in_data</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate percentiles in the way IDL and Matlab do it.</span>

<span class="sd">    By using interpolation between the lowest an highest rank and the</span>
<span class="sd">    minimum and maximum outside.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - shamelessly yoinked from https://github.com/numpy/numpy/issues/6620</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    in_data: numpy.ndarray</span>
<span class="sd">        input data</span>
<span class="sd">    percentiles: numpy.ndarray</span>
<span class="sd">        percentiles at which to calculate the values</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    perc: numpy.ndarray</span>
<span class="sd">        values of the percentiles</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span>
    <span class="n">p_rank</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span>
    <span class="n">perc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">percentiles</span><span class="p">,</span> <span class="n">p_rank</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">right</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">perc</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="magic" class="doc_header"><code>magic</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L543" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>magic</code>(<strong><code>data</code></strong>:<code>ndarray</code>, <strong><code>kernel</code></strong>:<code>ndarray</code>, <strong><code>t</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>rescale</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>logger</code></strong>:<code>Optional</code>[<code>Logger</code>]=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="Notes:">Notes:<a class="anchor-link" href="#Notes:"> </a></h2>
<pre><code>- Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/magic.m

- MAGIC (Markov Affinity based Gaussian Imputation of Cells) see:
    + https://www.biorxiv.org/content/early/2017/02/25/111591
    + https://arxiv.org/abs/1802.04927

</code></pre>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>data (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.


kernel (np.ndarray): N x N kernel or affinity matrix.

t (int): Time steps to apply MAGIC for. Controls low pass filter cutoff.
    Defaults to `1`.

rescale (bool): Rescale 95th percentile of imputed data to match original
    data. Defaults to `True`.

logger (logging.Logger): The logger to which to log to. Defaults to `None`.

</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>data_imputed (np.ndarray): M x D Data points imputed via MAGIC using kernel.

diffusion_operator (np.ndarray): M x M Markov matrix built from kernel.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">magic</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">kernel</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">t</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rescale</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes:</span>
<span class="sd">    ---------</span>
<span class="sd">        - Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/magic.m</span>

<span class="sd">        - MAGIC (Markov Affinity based Gaussian Imputation of Cells) see:</span>
<span class="sd">            + https://www.biorxiv.org/content/early/2017/02/25/111591</span>
<span class="sd">            + https://arxiv.org/abs/1802.04927</span>

<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        data (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.</span>


<span class="sd">        kernel (np.ndarray): N x N kernel or affinity matrix.</span>
<span class="sd">           </span>
<span class="sd">        t (int): Time steps to apply MAGIC for. Controls low pass filter cutoff.</span>
<span class="sd">            Defaults to `1`.</span>
<span class="sd">                    </span>
<span class="sd">        rescale (bool): Rescale 95th percentile of imputed data to match original</span>
<span class="sd">            data. Defaults to `True`.</span>

<span class="sd">        logger (logging.Logger): The logger to which to log to. Defaults to `None`.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">        data_imputed (np.ndarray): M x D Data points imputed via MAGIC using kernel.</span>

<span class="sd">        diffusion_operator (np.ndarray): M x M Markov matrix built from kernel.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Data does not match kernel size&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># build diffusion operator</span>
    <span class="n">diffusion_degree</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="o">-</span><span class="mi">1</span>
    <span class="p">)</span> 
    <span class="n">diffusion_degree</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">diffusion_degree</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">diffusion_operator</span> <span class="o">=</span> <span class="n">diffusion_degree</span> <span class="o">@</span> <span class="n">kernel</span>

    <span class="n">data_imputed</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="c1"># data_imputed = diffusion_operator * data_imputed</span>
        <span class="n">data_imputed</span> <span class="o">=</span> <span class="n">diffusion_operator</span> <span class="o">@</span> <span class="n">data_imputed</span>


    <span class="k">if</span> <span class="n">rescale</span><span class="p">:</span>
        <span class="c1"># NOTE: Heuristic by David to fix vanishing norm when multiplying by diffusion operator</span>
        <span class="n">data_imputed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
            <span class="n">data_imputed</span><span class="p">,</span> 
            <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">matlab_percentile</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="mi">95</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">matlab_percentile</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_imputed</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">data_imputed</span><span class="p">,</span> <span class="n">diffusion_operator</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mgc_magic" class="doc_header"><code>mgc_magic</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L612" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mgc_magic</code>(<strong><code>X</code></strong>:<code>ndarray</code>, <strong><code>Y</code></strong>:<code>ndarray</code>, <strong><code>s_hat</code></strong>:<code>ndarray</code>, <strong><code>sigma</code></strong>:<code>~SigmaType</code>=<em><code>'knn'</code></em>, <strong><code>k</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>a</code></strong>:<code>int</code>=<em><code>2</code></em>, <strong><code>fac</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>t</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>magic_rescale</code></strong>:<code>bool</code>=<em><code>1</code></em>, <strong><code>logger</code></strong>:<code>Optional</code>[<code>Logger</code>]=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="Notes:">Notes:<a class="anchor-link" href="#Notes:"> </a></h2>
<pre><code>- Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/mgc_magic.m

- MGC_MAGIC (Measure-based Gaussian Correlation Kernel w/ MAGIC):
    + https://arxiv.org/abs/1802.04927

- `sigma` (Gaussian kernel bandwidth)
    + `"std"`: standard deviation of the distances
    + `"knn"`: adaptive bandwidth, eg kth neighbor distance
    + `"minmax"`: min-max on the distance matrix
    + `"median"`: the median of the distances
    + `callable`: a function, f, such that f(d) returns a scalar or N-length vector
        where d is an NxN distance matrix
    + `scalar`: pre-computed bandwidth

- `a` (Alpha kernel decay)
    + `a=2` is Gaussian kernel

- `t`
    + `t=0`: [`mgc_magic`](/sugar/core.html#mgc_magic) is not called
    + `t&gt;0`: applies [`mgc_magic`](/sugar/core.html#mgc_magic) steps of diffusion.

</code></pre>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>X (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.

Y (np.ndarray): M x D Data matrix. N rows are measurements, D columns are features.

s_hat (np.ndarray): M x 1 measure vector. M entries correspond to measures on the rows of Y.

sigma (str | Callable): The type of sigma function to use or a user defined function.
    Valid `sigma` values include `"minmax"`, `"median"`, `"std"`, `"knn"`. Defaults to
    `"std"`.

k (int): K-nearest neighbor distance to use if `sigma="knn"`. Defaults to `5`.

a (int): Alpha-kernel decay parameter. Defaults to `1`. Note `a=2` is the Gaussian
    kernel.

fac (int): Rescale kernel bandwidth. Defaults to `1`.

t (int): Apply MGC MAGIC to diffuse new points. If less than `0` [`mgc_magic`](/sugar/core.html#mgc_magic)
    is not called. Defaults to `1`.

magic_rescale (bool): Rescale 95th percentile of imputed data to match original
    data. Defaults to `True`.

logger (logging.Logger): The logger to which to log to. Defaults to `None`.

</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>new_data (np.ndarray): M x D New points corrected using MGC MAGIC through X.

mgc_kernel (np.ndarray): M x M MGC kernel built over Y through X via `s_hat`.

mgc_diffusion_operator (np.ndarray): M x M row stochastic MGC
    markov matrix / diffusion operator</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mgc_magic</span><span class="p">(</span>
    <span class="n">X</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">Y</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">s_hat</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">sigma</span><span class="p">:</span><span class="n">SigmaType</span> <span class="o">=</span> <span class="s1">&#39;knn&#39;</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">a</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">fac</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">t</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">magic_rescale</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes:</span>
<span class="sd">    ---------</span>
<span class="sd">        - Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/mgc_magic.m</span>

<span class="sd">        - MGC_MAGIC (Measure-based Gaussian Correlation Kernel w/ MAGIC): </span>
<span class="sd">            + https://arxiv.org/abs/1802.04927</span>

<span class="sd">        - `sigma` (Gaussian kernel bandwidth)</span>
<span class="sd">            + `&quot;std&quot;`: standard deviation of the distances</span>
<span class="sd">            + `&quot;knn&quot;`: adaptive bandwidth, eg kth neighbor distance</span>
<span class="sd">            + `&quot;minmax&quot;`: min-max on the distance matrix</span>
<span class="sd">            + `&quot;median&quot;`: the median of the distances</span>
<span class="sd">            + `callable`: a function, f, such that f(d) returns a scalar or N-length vector</span>
<span class="sd">                where d is an NxN distance matrix</span>
<span class="sd">            + `scalar`: pre-computed bandwidth</span>

<span class="sd">        - `a` (Alpha kernel decay)</span>
<span class="sd">            + `a=2` is Gaussian kernel</span>

<span class="sd">        - `t`</span>
<span class="sd">            + `t=0`: `mgc_magic` is not called</span>
<span class="sd">            + `t&gt;0`: applies `mgc_magic` steps of diffusion. </span>

<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        X (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.</span>
<span class="sd">        </span>
<span class="sd">        Y (np.ndarray): M x D Data matrix. N rows are measurements, D columns are features.</span>

<span class="sd">        s_hat (np.ndarray): M x 1 measure vector. M entries correspond to measures on the rows of Y.</span>

<span class="sd">        sigma (str | Callable): The type of sigma function to use or a user defined function. </span>
<span class="sd">            Valid `sigma` values include `&quot;minmax&quot;`, `&quot;median&quot;`, `&quot;std&quot;`, `&quot;knn&quot;`. Defaults to </span>
<span class="sd">            `&quot;std&quot;`.</span>

<span class="sd">        k (int): K-nearest neighbor distance to use if `sigma=&quot;knn&quot;`. Defaults to `5`.</span>

<span class="sd">        a (int): Alpha-kernel decay parameter. Defaults to `1`. Note `a=2` is the Gaussian</span>
<span class="sd">            kernel.</span>

<span class="sd">        fac (int): Rescale kernel bandwidth. Defaults to `1`.</span>

<span class="sd">        t (int): Apply MGC MAGIC to diffuse new points. If less than `0` `mgc_magic`</span>
<span class="sd">            is not called. Defaults to `1`.</span>
<span class="sd">                    </span>
<span class="sd">        magic_rescale (bool): Rescale 95th percentile of imputed data to match original</span>
<span class="sd">            data. Defaults to `True`.</span>

<span class="sd">        logger (logging.Logger): The logger to which to log to. Defaults to `None`.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">        new_data (np.ndarray): M x D New points corrected using MGC MAGIC through X.</span>

<span class="sd">        mgc_kernel (np.ndarray): M x M MGC kernel built over Y through X via `s_hat`.</span>

<span class="sd">        mgc_diffusion_operator (np.ndarray): M x M row stochastic MGC </span>
<span class="sd">            markov matrix / diffusion operator</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">Y</span>
        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;mgc_magic was passed t=0, no mgc_magic was performed&#39;</span><span class="p">)</span>
    <span class="n">new_to_old</span><span class="p">,</span> <span class="n">sigma_nto</span> <span class="o">=</span> <span class="n">gauss_kernel</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fac</span><span class="p">)</span>
    <span class="n">old_to_new</span><span class="p">,</span> <span class="n">sigma_otn</span> <span class="o">=</span> <span class="n">gauss_kernel</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fac</span><span class="p">)</span>

    <span class="n">new_to_old_sparsity</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">new_to_old_sparsity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">new_to_old</span><span class="p">,</span> <span class="n">s_hat</span><span class="p">)</span>
    <span class="c1"># new_to_old_sparsity = np.matmul(new_to_old, s_hat)</span>

    <span class="c1"># NOTE: from matlab this is matrix multiply</span>
    <span class="c1"># mgc_kernel = new_to_old_sparsity * old_to_new</span>
    <span class="n">mgc_kernel</span> <span class="o">=</span> <span class="n">new_to_old_sparsity</span> <span class="o">@</span> <span class="n">old_to_new</span>
    <span class="n">mgc_kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span> <span class="p">(</span><span class="n">mgc_kernel</span> <span class="o">+</span> <span class="n">mgc_kernel</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">new_data</span><span class="p">,</span> <span class="n">mgc_diffusion_operator</span> <span class="o">=</span> <span class="n">magic</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">mgc_kernel</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">magic_rescale</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_data</span><span class="p">,</span> <span class="n">mgc_kernel</span><span class="p">,</span> <span class="n">mgc_diffusion_operator</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_data</span><span class="p">,</span> <span class="n">mgc_kernel</span><span class="p">,</span> <span class="n">mgc_diff</span> <span class="o">=</span> <span class="n">mgc_magic</span><span class="p">(</span><span class="n">pnts</span><span class="p">,</span> <span class="n">rnd_pnts</span><span class="p">,</span> <span class="n">s_hat</span><span class="p">,</span> <span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">new_data</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[-0.55784771, -0.81296597],
       [-0.73225017, -0.61892015],
       [-0.76553933, -0.53132798],
       [ 0.39515296,  0.93372422],
       [ 1.00019674, -0.10160751]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_data</span><span class="p">,</span> <span class="n">mgc_diffusion_operator</span> <span class="o">=</span> <span class="n">magic</span><span class="p">(</span><span class="n">rnd_pnts</span><span class="p">,</span> <span class="n">mgc_kernel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sugar" class="doc_header"><code>sugar</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L703" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sugar</code>(<strong><code>data</code></strong>:<code>ndarray</code>, <strong><code>labels</code></strong>:<code>list</code>=<em><code>[]</code></em>, <strong><code>noise_cov</code></strong>:<code>Union</code>[<code>int</code>, <code>float</code>, Literal['knn']<code>\]=*</code>'knn'<code>*, **</code>noise_k<code>**:</code>int<code>=*</code>5<code>*, **</code>sparsity_idx<code>**:</code>list<code>=*</code>[]<code>*, **</code>degree_sigma<code>**:</code>~SigmaType<code>=*</code>'std'<code>*, **</code>degree_k<code>**:</code>int<code>=*</code>5<code>*, **</code>degree_a<code>**:</code>int<code>=*</code>2<code>*, **</code>degree_fac<code>**:</code>int<code>=*</code>1<code>*, **</code>M<code>**:</code>int<code>=*</code>0<code>*, **</code>equalize<code>**:</code>bool<code>=*</code>False<code>*, **</code>mgc_t<code>**:</code>int<code>=*</code>1<code>*, **</code>mgc_sigma<code>**:</code>~SigmaType<code>=*</code>'knn'<code>*, **</code>mgc_k<code>**:</code>int<code>=*</code>5<code>*, **</code>mgc_a<code>**:</code>int<code>=*</code>2<code>*, **</code>mgc_fac<code>**:</code>int<code>=*</code>1<code>*, **</code>magic_rescale<code>**:</code>bool<code>=*</code>1<code>*, **</code>suppress<code>**:</code>bool<code>=*</code>False<code>*, **</code>logger<code>**:</code>Optional<code>\[</code>Logger<code>\]=*</code>None`*)</p>
</blockquote>
<h2 id="Notes:">Notes:<a class="anchor-link" href="#Notes:"> </a></h2>
<pre><code>- Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/sugar.m

- SUGAR (Geometry-based Data Generation)
    + https://arxiv.org/abs/1802.04927

- `degree_sigma` (Gaussian kernel bandwidth)
    + `"std"`: standard deviation of the distances
    + `"knn"`: adaptive bandwidth, eg kth neighbor distance
    + `"minmax"`: min-max on the distance matrix
    + `"median"`: the median of the distances
    + `callable`: a function, f, such that f(d) returns a scalar or N-length vector
        where d is an NxN distance matrix
    + `scalar`: pre-computed bandwidth

- `degree_a` (Alpha kernel decay)
    + `a=2` is Gaussian kernel

- `M` (number of points to generate)
    + `M and equalize`: then density equalization will be scaled by `M`. `M &lt; N`
        will negatively impact density equalization, `M &lt;&lt; N` is not recommended
        and `M &lt;&lt;&lt; N` may fail.

    + `not M and equalize`: then density equalization will not be scaled.

    + `M and not equalize`: then approximately `M` points will be generated
        according to a constant difference of max density.

    + `not M and not equalize`: then `M` is approximately N points.

- `mgc_t`
    + `mgc_t=0`: [`mgc_magic`](/sugar/core.html#mgc_magic) is not called
    + `mgc_t&gt;0`: applies [`mgc_magic`](/sugar/core.html#mgc_magic) steps of diffusion.

- `mgc_sigma` (Gaussian kernel bandwidth)
    + `"std"`: standard deviation of the distances
    + `"knn"`: adaptive bandwidth, eg kth neighbor distance
    + `"minmax"`: min-max on the distance matrix
    + `"median"`: the median of the distances
    + `callable`: a function, f, such that f(d) returns a scalar or N-length vector
        where d is an NxN distance matrix
    + `scalar`: pre-computed bandwidth

- `mgc_a` (Alpha kernel decay)
    + `a=2` is Gaussian kernel

</code></pre>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>data (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.

labels (list): N x 1 vector of classifier labels. Defaults to `[]`.

noise_cov (int|float|str): Bandwidth of Gaussian noise. Either scalar or `"knn"`.
    Defaults to `"knn"`.

noise_k (int): Neighborhood size for covariance estimation. Defaults to `5`.

sparsity_idx (list): Column indexes for sparsity estimation dimensions. If `[]`
    estimate sparsity in all dimensions. Defaults to `[]`.

degree_sigma (str | Callable): Diffusion kernel bandwith. The type of sigma function to
    use or a user defined function. Valid `sigma` values include `"minmax"`, `"median"`,
    `"std"`, `"knn"`. Defaults to `"knn"`.

degree_k (int): K-nearest neighbor distance to use if `degree_sigma="knn"`. Defaults to `5`.

degree_a (int): Alpha-kernel decay parameter. Defaults to `1`. Note `degree_a=2` is the
    Gaussian kernel.

degree_fac (int): Rescale mgc kernel bandwidth. Defaults to `1`.

M (int): Number of points to generate. Can affect strength of density equalization.
    Can accept positive scalars. Defaults to `0`.

equalize (bool): Density equalization. Can be affected by `M` (see notes). Defaults
    to `False`.

mgc_t (int): Apply MGC MAGIC to diffuse new points. If less than `0` [`mgc_magic`](/sugar/core.html#mgc_magic)
    is not called. Defaults to `1`.

mgc_sigma (str | Callable): Diffusion kernel bandwith. The type of sigma function to
    use or a user defined function. Valid `sigma` values include `"minmax"`, `"median"`,
    `"std"`, `"knn"`. Defaults to `"knn"`.

mgc_k (int): K-nearest neighbor distance to use if `mgc_sigma="knn"`. Defaults to `5`.

mgc_a (int): Alpha-kernel decay parameter. Defaults to `1`. Note `mgc_a=2` is the Gaussian
    kernel.

mgc_fac (int): Rescale mgc kernel bandwidth. Defaults to `1`.

magic_rescale (bool): Rescale 95th percentile of imputed data to match original
    data after MAGIC. Defaults to `True`.

suppress (bool): Enabled / disable point generation errors. Defaults to `False`.
    Deprecated.

logger (logging.Logger): The logger to which to log to. Defaults to `None`.

</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>Y (np.ndarray): M x D New points generated by SUGAR.

out_labels (np.ndarray): M x 1 New labels corresponding to `Y`.

d_hat (np.ndarray): N x 1 Degree estimate of data.

s_hat (np.ndarray): N x 1 Sparsity estimate of data.

sigma (np.ndarray): N x 1 or Scalar sigma used for `d_hat` computation.

noise (np.ndarray): N x D x D of local covariance matrices on `X`.

npts (np.ndarray): N x 1 number of points generated for each point in `X`.

random_points (np.ndarray): M x D random points generated around X.

mgc_kernel (np.ndarray): M x M kernel matrix of `Y` through data over `s_hat`.

mgc_diffusion_operator (np.ndarray): M x M markov matrix of `mgc_kernel`</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sugar</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">labels</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">noise_cov</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;knn&quot;</span><span class="p">]]</span><span class="o">=</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span>
    <span class="n">noise_k</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">sparsity_idx</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">degree_sigma</span><span class="p">:</span><span class="n">SigmaType</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span>
    <span class="n">degree_k</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">degree_a</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">degree_fac</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">M</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">equalize</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">mgc_t</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">mgc_sigma</span><span class="p">:</span><span class="n">SigmaType</span><span class="o">=</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span>
    <span class="n">mgc_k</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">mgc_a</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">mgc_fac</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">magic_rescale</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">suppress</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Notes:</span>
<span class="sd">    ---------</span>
<span class="sd">        - Adapted from https://github.com/KrishnaswamyLab/SUGAR/blob/master/matlab/sugar.m</span>

<span class="sd">        - SUGAR (Geometry-based Data Generation)    </span>
<span class="sd">            + https://arxiv.org/abs/1802.04927</span>

<span class="sd">        - `degree_sigma` (Gaussian kernel bandwidth)</span>
<span class="sd">            + `&quot;std&quot;`: standard deviation of the distances</span>
<span class="sd">            + `&quot;knn&quot;`: adaptive bandwidth, eg kth neighbor distance</span>
<span class="sd">            + `&quot;minmax&quot;`: min-max on the distance matrix</span>
<span class="sd">            + `&quot;median&quot;`: the median of the distances</span>
<span class="sd">            + `callable`: a function, f, such that f(d) returns a scalar or N-length vector</span>
<span class="sd">                where d is an NxN distance matrix</span>
<span class="sd">            + `scalar`: pre-computed bandwidth</span>

<span class="sd">        - `degree_a` (Alpha kernel decay)</span>
<span class="sd">            + `a=2` is Gaussian kernel</span>

<span class="sd">        - `M` (number of points to generate)</span>
<span class="sd">            + `M and equalize`: then density equalization will be scaled by `M`. `M &lt; N`</span>
<span class="sd">                will negatively impact density equalization, `M &lt;&lt; N` is not recommended</span>
<span class="sd">                and `M &lt;&lt;&lt; N` may fail.</span>

<span class="sd">            + `not M and equalize`: then density equalization will not be scaled.</span>
<span class="sd">            </span>
<span class="sd">            + `M and not equalize`: then approximately `M` points will be generated</span>
<span class="sd">                according to a constant difference of max density.</span>
<span class="sd">            </span>
<span class="sd">            + `not M and not equalize`: then `M` is approximately N points.</span>

<span class="sd">        - `mgc_t`</span>
<span class="sd">            + `mgc_t=0`: `mgc_magic` is not called</span>
<span class="sd">            + `mgc_t&gt;0`: applies `mgc_magic` steps of diffusion. </span>

<span class="sd">        - `mgc_sigma` (Gaussian kernel bandwidth)</span>
<span class="sd">            + `&quot;std&quot;`: standard deviation of the distances</span>
<span class="sd">            + `&quot;knn&quot;`: adaptive bandwidth, eg kth neighbor distance</span>
<span class="sd">            + `&quot;minmax&quot;`: min-max on the distance matrix</span>
<span class="sd">            + `&quot;median&quot;`: the median of the distances</span>
<span class="sd">            + `callable`: a function, f, such that f(d) returns a scalar or N-length vector</span>
<span class="sd">                where d is an NxN distance matrix</span>
<span class="sd">            + `scalar`: pre-computed bandwidth</span>

<span class="sd">        - `mgc_a` (Alpha kernel decay)</span>
<span class="sd">            + `a=2` is Gaussian kernel</span>

<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        data (np.ndarray): N x D Data matrix. N rows are measurements, D columns are features.</span>

<span class="sd">        labels (list): N x 1 vector of classifier labels. Defaults to `[]`.</span>
<span class="sd">        </span>
<span class="sd">        noise_cov (int|float|str): Bandwidth of Gaussian noise. Either scalar or `&quot;knn&quot;`.</span>
<span class="sd">            Defaults to `&quot;knn&quot;`.</span>
<span class="sd">        </span>
<span class="sd">        noise_k (int): Neighborhood size for covariance estimation. Defaults to `5`.</span>

<span class="sd">        sparsity_idx (list): Column indexes for sparsity estimation dimensions. If `[]`</span>
<span class="sd">            estimate sparsity in all dimensions. Defaults to `[]`.</span>

<span class="sd">        degree_sigma (str | Callable): Diffusion kernel bandwith. The type of sigma function to </span>
<span class="sd">            use or a user defined function. Valid `sigma` values include `&quot;minmax&quot;`, `&quot;median&quot;`, </span>
<span class="sd">            `&quot;std&quot;`, `&quot;knn&quot;`. Defaults to `&quot;knn&quot;`.</span>

<span class="sd">        degree_k (int): K-nearest neighbor distance to use if `degree_sigma=&quot;knn&quot;`. Defaults to `5`.</span>

<span class="sd">        degree_a (int): Alpha-kernel decay parameter. Defaults to `1`. Note `degree_a=2` is the </span>
<span class="sd">            Gaussian kernel.</span>
<span class="sd">        </span>
<span class="sd">        degree_fac (int): Rescale mgc kernel bandwidth. Defaults to `1`.</span>
<span class="sd">     </span>
<span class="sd">        M (int): Number of points to generate. Can affect strength of density equalization.</span>
<span class="sd">            Can accept positive scalars. Defaults to `0`.</span>

<span class="sd">        equalize (bool): Density equalization. Can be affected by `M` (see notes). Defaults</span>
<span class="sd">            to `False`.</span>

<span class="sd">        mgc_t (int): Apply MGC MAGIC to diffuse new points. If less than `0` `mgc_magic`</span>
<span class="sd">            is not called. Defaults to `1`.</span>

<span class="sd">        mgc_sigma (str | Callable): Diffusion kernel bandwith. The type of sigma function to </span>
<span class="sd">            use or a user defined function. Valid `sigma` values include `&quot;minmax&quot;`, `&quot;median&quot;`, </span>
<span class="sd">            `&quot;std&quot;`, `&quot;knn&quot;`. Defaults to `&quot;knn&quot;`.</span>

<span class="sd">        mgc_k (int): K-nearest neighbor distance to use if `mgc_sigma=&quot;knn&quot;`. Defaults to `5`.</span>

<span class="sd">        mgc_a (int): Alpha-kernel decay parameter. Defaults to `1`. Note `mgc_a=2` is the Gaussian</span>
<span class="sd">            kernel.</span>

<span class="sd">        mgc_fac (int): Rescale mgc kernel bandwidth. Defaults to `1`.</span>
<span class="sd">                    </span>
<span class="sd">        magic_rescale (bool): Rescale 95th percentile of imputed data to match original</span>
<span class="sd">            data after MAGIC. Defaults to `True`.</span>

<span class="sd">        suppress (bool): Enabled / disable point generation errors. Defaults to `False`.</span>
<span class="sd">            Deprecated.</span>

<span class="sd">        logger (logging.Logger): The logger to which to log to. Defaults to `None`.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">        Y (np.ndarray): M x D New points generated by SUGAR.</span>

<span class="sd">        out_labels (np.ndarray): M x 1 New labels corresponding to `Y`.</span>

<span class="sd">        d_hat (np.ndarray): N x 1 Degree estimate of data.</span>

<span class="sd">        s_hat (np.ndarray): N x 1 Sparsity estimate of data.</span>

<span class="sd">        sigma (np.ndarray): N x 1 or Scalar sigma used for `d_hat` computation.</span>

<span class="sd">        noise (np.ndarray): N x D x D of local covariance matrices on `X`.</span>

<span class="sd">        npts (np.ndarray): N x 1 number of points generated for each point in `X`.</span>

<span class="sd">        random_points (np.ndarray): M x D random points generated around X.</span>

<span class="sd">        mgc_kernel (np.ndarray): M x M kernel matrix of `Y` through data over `s_hat`.</span>

<span class="sd">        mgc_diffusion_operator (np.ndarray): M x M markov matrix of `mgc_kernel`</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Initializing SUGAR&#39;</span><span class="p">)</span>
    <span class="c1"># [data, params] = init(data, varagin{:})</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Obtaining Degree Estimate&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sparsity_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sparsity_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="n">d_hat</span><span class="p">,</span> <span class="n">s_hat</span><span class="p">,</span> <span class="n">degree_sigma</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">degree_sigma</span><span class="p">,</span>
        <span class="n">k</span><span class="o">=</span><span class="n">degree_k</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">degree_a</span><span class="p">,</span> <span class="n">fac</span><span class="o">=</span><span class="n">degree_fac</span><span class="p">,</span>
        <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;d_hat: </span><span class="si">{</span><span class="n">d_hat</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;s_hat: </span><span class="si">{</span><span class="n">s_hat</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;degree_sigma: </span><span class="si">{</span><span class="n">degree_sigma</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">noise_cov</span> <span class="o">==</span> <span class="s1">&#39;knn&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Local Covariance estimation&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">noise_k</span><span class="p">)</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">local_covariance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">noise_k</span><span class="p">)</span>
        <span class="n">noise_cov</span> <span class="o">=</span> <span class="n">noise</span>
    
    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Estimating number of points to generate&#39;</span><span class="p">)</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="n">numpts</span><span class="p">(</span>
        <span class="n">d_hat</span><span class="p">,</span> <span class="n">noise_cov</span><span class="o">=</span><span class="n">noise_cov</span><span class="p">,</span> <span class="n">kernel_sigma</span><span class="o">=</span><span class="n">degree_sigma</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span>
        <span class="n">equalize</span><span class="o">=</span><span class="n">equalize</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="n">suppress</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Generating points&#39;</span><span class="p">)</span>
    <span class="n">random_points</span><span class="p">,</span> <span class="n">out_labels</span> <span class="o">=</span> <span class="n">generate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">npts</span><span class="p">,</span> <span class="n">noise_cov</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mgc_t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Diffusing points via MGC Magic&#39;</span><span class="p">)</span>
        <span class="n">Y</span><span class="p">,</span> <span class="n">mgc_kernel</span><span class="p">,</span> <span class="n">mgc_diffusion_operator</span> <span class="o">=</span> <span class="n">mgc_magic</span><span class="p">(</span>
            <span class="n">X</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">random_points</span><span class="p">,</span> 
            <span class="n">s_hat</span><span class="o">=</span><span class="n">s_hat</span><span class="p">,</span>  <span class="n">sigma</span><span class="o">=</span><span class="n">mgc_sigma</span><span class="p">,</span> 
            <span class="n">a</span><span class="o">=</span><span class="n">mgc_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">mgc_k</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">mgc_t</span><span class="p">,</span>
            <span class="n">fac</span><span class="o">=</span><span class="n">mgc_fac</span><span class="p">,</span> <span class="n">magic_rescale</span><span class="o">=</span><span class="n">magic_rescale</span><span class="p">,</span>
            <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
        <span class="p">)</span>
        <span class="k">pass</span>
    <span class="c1"># NOTE: (@Jay) assumed that this was there for debugging purposes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">random_points</span>
        <span class="n">mgc_kernel</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mgc_diffusion_operator</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">return</span> <span class="n">Y</span><span class="p">,</span> <span class="n">out_labels</span><span class="p">,</span> <span class="n">d_hat</span><span class="p">,</span> <span class="n">s_hat</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">npts</span><span class="p">,</span> <span class="n">random_points</span><span class="p">,</span> <span class="n">mgc_kernel</span><span class="p">,</span> <span class="n">mgc_diffusion_operator</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_imbalanced_circle" class="doc_header"><code>generate_imbalanced_circle</code><a href="https://github.com/dsm-72/sugar/tree/main/sugar/core.py#L904" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_imbalanced_circle</code>(<strong><code>n_points</code></strong>:<code>int</code>=<em><code>100</code></em>, <strong><code>n_total</code></strong>:<code>int</code>=<em><code>10000</code></em>, <strong><code>weight</code></strong>:<code>float</code>=<em><code>1.2</code></em>)</p>
</blockquote>
<h2 id="Arugments:">Arugments:<a class="anchor-link" href="#Arugments:"> </a></h2>
<pre><code>n_points (int): number of points to sample from unit circle. Defaults to `100`.

n_total (int): number of points to generate uniformly on the unit circle. Defaults ot `10000`.

weight (float): weight modifier for how much to emphasize the x coordinate on the unit circle.
    Defaults to `1.2`. Setting this to `1` results in almost no points on the lefthand side of
    the circle. Setting it to `2` results in a more uniform balance.

</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>points (np.ndarray): 2 X `n_points` array of the points on the unit circle.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">def</span> <span class="nf">generate_imbalanced_circle</span><span class="p">(</span>
    <span class="n">n_points</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_total</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
    <span class="n">weight</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">1.2</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Arugments:</span>
<span class="sd">    ----------</span>
<span class="sd">        n_points (int): number of points to sample from unit circle. Defaults to `100`.</span>

<span class="sd">        n_total (int): number of points to generate uniformly on the unit circle. Defaults ot `10000`.</span>
<span class="sd">        </span>
<span class="sd">        weight (float): weight modifier for how much to emphasize the x coordinate on the unit circle.</span>
<span class="sd">            Defaults to `1.2`. Setting this to `1` results in almost no points on the lefthand side of </span>
<span class="sd">            the circle. Setting it to `2` results in a more uniform balance.</span>

<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">        points (np.ndarray): 2 X `n_points` array of the points on the unit circle.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_total</span><span class="p">),</span> <span class="p">))</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
    <span class="n">pnts</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span>
        <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
            <span class="n">weights</span><span class="o">=</span><span class="n">weight</span><span class="o">+</span><span class="n">coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> 
            <span class="n">k</span><span class="o">=</span><span class="n">n_points</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">pnts</span>

<span class="n">pnts</span> <span class="o">=</span> <span class="n">generate_imbalanced_circle</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pnts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pnts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x7f6564a4dca0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pnts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;points.csv&#39;</span><span class="p">),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Y</span><span class="p">,</span> <span class="n">out_labels</span><span class="p">,</span> <span class="n">d_hat</span><span class="p">,</span> <span class="n">s_hat</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">npts</span><span class="p">,</span> <span class="n">random_points</span><span class="p">,</span> <span class="n">mgc_kernel</span><span class="p">,</span> <span class="n">mgc_diffusion_operator</span> <span class="o">=</span> <span class="n">sugar</span><span class="p">(</span>
    <span class="n">pnts</span><span class="p">,</span> 
    <span class="n">labels</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">noise_cov</span><span class="o">=</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span>
    <span class="n">noise_k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">sparsity_idx</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">degree_sigma</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span>
    <span class="n">degree_k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">degree_a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">degree_fac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">equalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">mgc_t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">mgc_sigma</span><span class="o">=</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span>
    <span class="n">mgc_k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">mgc_a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">mgc_fac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">magic_rescale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">suppress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[ 0.33359213 -0.9427175 ]
 [-0.42965306 -0.90299405]
 [-0.7353374  -0.67770119]
 [ 0.28820755 -0.95756797]
 [ 0.46866687  0.88337499]
 [ 0.9955906  -0.0938049 ]
 [-0.44603613 -0.89501496]
 [ 0.62639811 -0.77950331]
 [ 0.92082986 -0.38996458]
 [ 0.67039048 -0.74200849]
 [ 0.81721009 -0.57633989]
 [-0.45613077 -0.88991276]
 [ 0.81357237 -0.58146367]
 [ 0.87824304 -0.47821456]
 [ 0.95860306 -0.2847458 ]
 [ 0.87733998  0.47986932]
 [ 0.9547622  -0.29737037]
 [-0.53786258  0.84303253]
 [-0.7400042   0.67260225]
 [ 0.39905879  0.91692534]
 [ 0.962277    0.27207164]
 [ 0.32231328 -0.94663306]
 [-0.98637491 -0.16451304]
 [ 0.69653189  0.71752584]
 [-0.23942126  0.97091578]
 [ 0.99058897  0.13687034]
 [ 0.97652497  0.21540423]
 [ 0.97666013 -0.21479056]
 [ 0.22015729 -0.97546438]
 [ 0.99399418  0.10943294]
 [ 0.40653571  0.91363489]
 [ 0.72913207 -0.68437302]
 [ 0.58999447  0.80740729]
 [ 0.83491185 -0.55038368]
 [-0.28308886 -0.95909368]
 [ 0.90034475 -0.43517735]
 [ 0.97272999 -0.23194045]
 [ 0.87522071 -0.4837238 ]
 [ 0.80246703 -0.59669646]
 [ 0.42993675 -0.90285901]
 [ 0.99947641  0.03235599]
 [ 0.78605309 -0.61815899]
 [ 0.90494207  0.42553479]
 [-0.94769122 -0.31918859]
 [ 0.86437119  0.50285429]
 [ 0.79756592 -0.60323179]
 [-0.30171695  0.95339755]
 [-0.22842428  0.97356168]
 [ 0.24825773 -0.96869402]
 [ 0.04726808 -0.99888224]
 [ 0.91885786 -0.39458869]
 [ 0.92754828  0.37370335]
 [ 0.9932869  -0.11567682]
 [-0.30889747 -0.95109534]
 [-0.01115354 -0.9999378 ]
 [-0.44828436 -0.89389101]
 [ 0.05479881 -0.99849742]
 [ 0.91228876  0.40954758]
 [ 0.88330135  0.46880564]
 [ 0.42596123 -0.90474142]
 [ 0.19002247 -0.98177974]
 [ 0.93057006  0.36611386]
 [ 0.77306651 -0.63432497]
 [ 0.33714407 -0.94145307]
 [-0.23087063 -0.97298446]
 [ 0.16714668  0.98593204]
 [ 0.08989412  0.99595133]
 [ 0.46811168 -0.88366931]
 [ 0.2954199   0.95536751]
 [ 0.02654599  0.99964759]
 [ 0.75892974 -0.65117252]
 [ 0.95230117  0.30515978]
 [ 0.70816128 -0.7060507 ]
 [ 0.92660604  0.37603358]
 [ 0.75688008 -0.65355378]
 [ 0.81320683 -0.58197479]
 [ 0.6778167   0.73523093]
 [ 0.44181311  0.89710712]
 [ 0.39905879  0.91692534]
 [-0.13142171  0.99132655]
 [ 0.93861339 -0.34497088]
 [ 0.39039851  0.92064597]
 [ 0.99982819 -0.01853619]
 [ 0.93861339  0.34497088]
 [ 0.70549424 -0.70871565]
 [ 0.44968807 -0.89318567]
 [ 0.74693803  0.66489366]
 [ 0.60310649  0.79766068]
 [ 0.92825111 -0.37195412]
 [ 0.90007112  0.43574303]
 [-0.51596691 -0.85660852]
 [ 0.81648512 -0.57736647]
 [ 0.1435587  -0.9896418 ]
 [ 0.16900501 -0.98561519]
 [-0.07580426 -0.99712272]
 [ 0.51462058 -0.85741802]
 [ 0.80508393  0.59316091]
 [ 0.02214863 -0.99975469]
 [-0.02748822 -0.99962213]
 [ 0.99254041  0.12191612]] 2
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/tmp/ipykernel_40939/1440296221.py:101: RuntimeWarning: covariance is not positive-semidefinite.
  np.random.multivariate_normal(row, rep_cov[i])
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Y</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pnts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pnts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x7ff1000e0370&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

